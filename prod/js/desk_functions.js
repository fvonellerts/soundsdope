function extoolbar_close(){$(".extended_toolbar").hasClass("opened")&&($(".extended_toolbar").addClass("closed"),$(".extended_toolbar").removeClass("opened"))}function extoolbar_open(){close_popup(),$(".extended_toolbar").addClass("opened"),$(".extended_toolbar").removeClass("closed")}function rightclick_action(e){if(remove_rightclick(),"cancel"!==e)switch(extoolbar_close(),e){case"desk_add":desk_add($rc_referer.data("id"));break;case"desk_remove":desk_remove($rc_referer.data("id"));break;case"track_play":track_play($rc_referer.data("song-id"));break;case"track_playlist_add":playlist_track_add($rc_referer.data("song-id"));break;case"track_playlist_remove":playlist_track_remove();break;case"album_playlist_remove":playlist_album_remove();break;case"desk_playlist":$.ajax({dataType:"json",method:"POST",url:"php/filter/filter.php",data:{album:$rc_referer.data("id")}}).done(function(e){json_errorcheck(e),$.each(e,function(e,t){playlist_track_add(t.id)})});break;case"desk_playlist_add":playlist_combine($rc_referer.data("playlist"));break;case"desk_playlist_remove":playlist_delete($rc_referer.data("playlist"));break;case"desk_playlist_rename":playlist_rename($rc_referer.data("playlist"));break;case"track_download":window.location="php/download/track.php?id="+$rc_referer.data("song-id");break;case"album_view":album_popup2($rc_referer.data("id"))}}function desk_add(e){var t=ls_custom.get("soundsdope");$.ajax({dataType:"json",method:"POST",url:"php/filter/filter.php",data:{album_data:e}}).done(function(a){json_errorcheck(a),$.each(a,function(a,s){var o={id:e,order:t.albums.length+1,artist:s.artist,title:s.title};t.albums.push(o),ls_custom.set("soundsdope",JSON.stringify(t)),desk_add_ui(e,s.artist,s.title)})})}function desk_remove(e){if(ls_custom.isSet("soundsdope")){var t=ls_custom.get("soundsdope"),a="",s="";$.each(t.albums,function(t,o){o.id==e&&(a=t,s=o.order)}),t.albums.splice(a,1),ls_custom.set("soundsdope",JSON.stringify(t))}desk_remove_ui()}function desk_search(){var e=$("#desk_search").val();if(""!==e){var t=ls_custom.get("soundsdope"),a=!0;$("#desk_content").empty(),$.each(t.albums,function(t,s){(-1!=s.title.search(new RegExp(e,"i"))||-1!=s.artist.search(new RegExp(e,"i")))&&(desk_add_ui(s.id,s.artist,s.title),a=!1)}),a&&show_placeholder(4)}else reset_desk()}function cloud_fullsearch(e){query="cloud_fullsearch('"+e+"')";var t=$("#cloud_search").val();extoolbar_close(),$.ajax({dataType:"json",method:"POST",url:"php/filter/fullsearch.php",data:{type:e,search:t,limit:limit_string}}).done(function(e){json_errorcheck(e),hide_placeholder(1),$.each(e,function(e,t){cloud_add_ui(t.id,t.artist,t.title)}),check_limit()})}function cloud_search(){var e=$("#cloud_search").val();return e.length<1?($("#sz_artists").prev().removeClass("active"),$("#sz_artists").html(""),$("#sz_albums").prev().removeClass("active"),$("#sz_albums").html(""),$("#sz_tracks").prev().removeClass("active"),$("#sz_tracks").html(""),$("#sz_playlists").prev().removeClass("active"),$("#sz_playlists").html(""),void extoolbar_close()):(extoolbar_open(),void $.ajax({dataType:"json",method:"POST",url:"php/filter/search.php",data:{search:e}}).done(function(e){json_errorcheck(e),$("#sz_artists").prev().removeClass("active"),$("#sz_artists").html(""),$("#sz_albums").prev().removeClass("active"),$("#sz_albums").html(""),$("#sz_tracks").prev().removeClass("active"),$("#sz_tracks").html(""),$.each(e,function(e,t){$.each(t,function(e,t){switch(t.type){case"artist":$("<li/>").data("id",t.id).html(t.name).appendTo("#sz_artists"),$("#sz_artists").prev().addClass("active");break;case"album":$("<li/>").data("id",t.id).data("action","album").html("<img src='php/stream/image.php?id="+t.id+"'/><p>"+t.title+"<br><span>"+t.artist+"</span></p><span class='rc' data-action='album'><i class='material-icons'>more_horiz</i></span>").appendTo("#sz_albums"),$("#sz_albums").prev().addClass("active");break;case"track":$("<li/>").data("song-id",t.id).data("id",t.albumid).data("action","track").html("<p>"+t.name+"</p><span class='rc' data-action='popup_track'><i class='material-icons'>more_horiz</i></span><span>"+t.artist+"</span>").appendTo("#sz_tracks"),$("#sz_tracks").prev().addClass("active")}})})}))}function list_artist(e){$.ajax({dataType:"json",method:"POST",url:"php/filter/filter.php",data:{artist:e}}).done(function(e){json_errorcheck(e),hide_placeholder(1),$.each(e,function(e,t){cloud_add_ui(t.id,t.artist,t.title)})})}function settings_switch(e,t){var a="#settings_"+e;if(ls_custom.isSet("soundsdope")){var s=ls_custom.get("soundsdope"),o=!0;if($.each(s.settings,function(t,a){if(a.name==e){o=!1;var s=a.value;s="true"==s?"false":"false"==s?"true":"0"==s?"1":"1"==s?"2":"0",a.value=s,settings_restore(e,s)}}),o){if("switch"==t)var i={name:e,value:"true"};else var i={name:e,value:"1"};"random"==e?globals_random=!0:"preload"==e?globals_preload=!0:"repeat"==e&&(globals_repeat=1),s.settings.push(i),$(a).addClass("active"),$(a).find("#settings_repeat_icon").html("repeat")}ls_custom.set("soundsdope",JSON.stringify(s)),track_next()}}function settings_restore(e,t){var a="#settings_"+e,s="globals_"+e;switch(t){case"2":$(a).addClass("active"),$(a).find("#settings_repeat_icon").html("repeat_one"),window[s]=2;break;case"0":$(a).removeClass("active"),$(a).find("#settings_repeat_icon").html("repeat"),window[s]=0;break;case"1":$(a).addClass("active"),$(a).find("#settings_repeat_icon").html("repeat"),window[s]=1;break;case"true":$(a).addClass("active"),window[s]=!0;break;case"false":$(a).removeClass("active"),window[s]=!1}}function genre_list(e){extoolbar_close(),query="genre_list('"+e+"')",$.ajax({dataType:"json",method:"POST",url:"php/filter/filter.php",data:{genre:e,limit:limit_string}}).done(function(e){json_errorcheck(e),hide_placeholder(1),$.each(e,function(e,t){cloud_add_ui(t.id,t.artist,t.title)}),check_limit()})}function hide_placeholder(e){switch(e){case 1:$("#cloud_placeholder").hide(),$("#cloud_content").empty();break;case 2:$("#playlist_placeholder").hide()}}function show_placeholder(e){switch(e){case 1:$("#cloud_placeholder").show(),$("#cloud_placeholder p").text("Nothing found!");break;case 2:$("#cloud_placeholder").show(),$("#cloud_placeholder p").text("Search or list content...");break;case 3:$("#desk_placeholder").show(),$("#desk_placeholder p").text("");break;case 4:$("#desk_placeholder").show(),$("#desk_placeholder p").text("Nothing found!");break;case 5:$("#playlist_placeholder").show(),$("#playlist_placeholder p").text("Playlist empty...")}}function check_limit(){var e='<div class="loadbuttoncontainer"><div onclick="raise_limit()" id="load_button">Load '+limit_string+" more</div></div>";$("#cloud_content").find("li").length==limit_string&&$("#cloud_content").append(e)}function raise_limit(){limit_string=2*limit_string,repeat_query()}function repeat_query(){jQuery.globalEval(query)}function notyfication(e,t){switch(t){case"save_notitle":t="Please enter a name to save under.";break;case"invalid_sql":t="Nothing found.";break;case"wip":t="This feature is still in development.";break;default:t="An error occured."}noty({text:t,layout:"topRight",theme:"relax",timeout:2e3,type:e})}function notyconfirm(e,t){noty({layout:"topRight",theme:"relax",type:"warning",text:e,buttons:[{text:"Cancel",onClick:function(e){e.close()}},{text:"Yes",onClick:function(e){e.close(),window[t]()}}]})}function json_errorcheck(e){if("error"===e.state)throw new json_error(e.type)}function json_error(){var e=Error.apply(this,arguments);notyfication("error",e.message)}function tour_start(){var e=new Tour({storage:!1,steps:[{element:"#open_playlist",title:"The three sections",content:"Soundsdope is split into three parts. You can switch between the sections using these icons."},{element:"#open_desk",title:"Your Favorites",content:"When you visit soundsdope, this is the first section you see. It's where your favorite albums and saved playlists are stored. Since soundsdope uses local storage, you wont loose your desk unless you delete your browser data."},{element:"#open_cloud",title:"The Store",content:"This is where you get your music from. You can either search for any artist, album or track or filter albums by genre. The store is completely free and can be used without limits or ads."},{element:"#open_playlist",title:"The Playlist",content:"By default soundsdope plays throughout the album. However, you are able to create playlists and listen to your own mixtapes."},{element:".toolbar",title:"The Functions",content:"Below the section switcher, the different functions within the current section are listed."},{title:"Freedom streaming",content:"How about taking a trip to the clouds and discovering the endless possibilities of soundsdope? If you would like to suggest or ask something, feel free to contact me over 99.9Xz21gxhj9@hmamail.com.",orphan:!0}]});e.init(),e.start()}var limit_string=24,query;$(document).keyup(function(e){27==e.keyCode&&extoolbar_close(),40==e.keyCode&&skip_backward(),38==e.keyCode&&skip_forward(),$("input").is(":focus")?$("#cloud_search").is(":focus")?13==e.keyCode&&cloud_search():$("#desk_search").is(":focus")&&13==e.keyCode&&desk_search():(32==e.keyCode&&switch_play(),119==e.keyCode&&switch_play(),118==e.keyCode&&skip_backward(),120==e.keyCode&&skip_forward(),37==e.keyCode&&skip_backward(),39==e.keyCode&&skip_forward(),83==e.keyCode&&screenup("cloud"),65==e.keyCode&&screenup("playlist"),68==e.keyCode&&screenup("desk"))}),$("#desk_search").on("input",function(e){desk_search()}),$("#desk_search").focus(function(){desk_search()}),$("#cloud_search").on("input",function(e){cloud_search()}),$("#cloud_search").focus(function(){cloud_search()}),$("#settings_repeat").click(function(){settings_switch("repeat","count")}),$("#settings_random").click(function(){settings_switch("random","switch")}),$("#settings_preload").click(function(){settings_switch("preload","switch")}),$("#fullsearch_albums").click(function(){$(this).hasClass("active")&&cloud_fullsearch("albums")}),$("#tour").click(function(){tour_start()}),$.fn.uiremove=function(){$(this).addClass("uidelete"),$(".uidelete").on("transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",function(){$(this).remove()})},$.fn.uiadd=function(){$(this).addClass("uiadd"),$(".uiadd").on("transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",function(){$(this).removeClass("uiadd")})},$("#select_genre li").click(function(){if($(this).data("genre")){var e=$(this).data("genre");genre_list(e)}else $("#select_genre").find("ul").not($(this).find("ul")).removeClass("active"),$(this).find("ul").hasClass("active")?$(this).find("ul").removeClass("active"):$(this).find("ul").addClass("active")}),$(".toolbar li").click(function(){extoolbar_close(),$(this).data("id")&&($(".extended_toolbar .content > ul").removeClass("active"),$(".extended_toolbar").find("#"+$(this).data("id")).addClass("active"),extoolbar_open())}),$(document).on("click","#search_zone > ul",function(){extoolbar_close()}),$(document).on("click","#sz_artists > li",function(){list_artist($(this).data("id"))}),$(document).on("click","#sz_albums > li, #player_info, #desk_content > li, #cloud_content > li",function(){extoolbar_close(),album_popup2($(this).data("id"))}),$(document).on("click","#sz_tracks > li, #album_content > li, #playlist_content .albumview > li",function(){track_play($(this).data("song-id"))}),$(document).on("contextmenu","#sz_albums > li, #desk_content > li, #cloud_content > li, #sz_tracks > li, #player_info, #album_info",function(e){return $rc_referer=$(this),rightclick_popup(e,$(this).data("action")),!1}),json_error.prototype=new Error;